<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Relatório de Clientes</title>
    <link rel="stylesheet" href="/css/relatorio.css">
</head>
<body>

    

    <section class="caixasnumeradas">
        <article class="caixas">
            <h3>Trabalhos Solicitados</h3>
            <p id="numeros">2</p>
        </article>
        <article class="caixas">
            <h3>Trabalhos Finalizados</h3>
            <p id="numeros">1</p>
        </article>
    </section>
    <section class="conteiner">
        <section class="tab_box">
            <button class="tab_btn active">Projetos</button>
            <button class="tab_btn">Pagamentos</button>
            <button class="tab_btn">Comissão</button>
            <section class="line"></section>
        </section>
        <section class="content_box">
             <section class="content active">
            <h1>Solicitações Recebidas</h1>
            <table id="requestTable">
                <thead>
                    <tr>
                        <th>Nome</th>
                        <th>Número</th>
                        <th>CEP</th>
                        <th>Valor</th>
                        <th>Ações</th>
                    </tr>
                </thead>
                <tbody>
                    
                <% let situacoes=["Pendente", "Em andamento", "Finalizada", "Cancelada" ]
                relatorio.forEach(function(relatorio){ %>

                <tr>
                    <td>
                        <%=relatorio.nome_relatorio %>
                    </td>
                    <td>
                        <!-- <%=relatorio.prazo_tarefa %> -->
                        <%= relatorio.telefone_relatorio formatPhoneNumber(phoneNumber) %>
                    </td>
                    <td>
                        <%= cep %>
                    </td>
                    <td>
                        <%= amount %>
                    </td>
                    <td>
                
                        <td>
                            <button onclick=<%=" window.location='/aceitar?id="+ tarefa.id_tarefa+"'" %> class="
                                material-symbols-outlined done_outline">
                                done_outline
                            </button>
                        </td>
                        <td>
                            <button onclick=<%=" window.location='/excluir?id="+ tarefa.id_tarefa+"'" %> class="
                                material-symbols-outlined delete">
                                delete
                            </button>
                        </td>
                    </td>
                </tbody>
            </table>
        </section>
        <section class="content">
            <h1>Pagamentos do Cliente</h1>
            <table id="paymentTable">
                <thead>
                    <tr>
                        <th>Nome do Cliente</th>
                        <th>Valor do Pagamento</th>
                        <th>Nota fiscal</th> 
                    </tr>
                </thead>
                <tbody>
                       
                <% let situacoes=["Pendente", "Em andamento", "Finalizada", "Cancelada" ]
                relatorio.forEach(function(relatorio){ %>

                <tr>
                    <td>
                        <%=relatorio.nome_relatorio %>
                    </td>
                    <td>
                        <!-- <%=relatorio.prazo_tarefa %> -->
                        <%= moment(relatorio.prazo_relatorio).format( 'DD/MM/YYYY') %>
                    </td>
                    <td>
                        <%= situacoes[relatorio.situacao_relatorio]%>
                    </td>
                    <td>
                
                        <td>
                            <button onclick=<%=" window.location='/aceitar?id="+ tarefa.id_tarefa+"'" %> class="
                                material-symbols-outlined done_outline">
                                done_outline
                            </button>
                        </td>
                        <td>
                            <button onclick=<%=" window.location='/excluir?id="+ tarefa.id_tarefa+"'" %> class="
                                material-symbols-outlined delete">
                                delete
                            </button>
                        </td>
                    </td>
                </tbody>
            </table>
        </section>
        <section class="content">
            <h1>Registro de Comissão</h1>
            <table id="commissionTable">
                <thead>
                    <tr>
                        <th>Nome do Profissional</th>
                        <th>Valor da Comissão</th>
                        <th>Ações</th>
                    </tr>
                </thead>
                <tbody>
                      
                <%} let situacoes=["Pendente", "Em andamento", "Finalizada", "Cancelada" ]
                relatorio.forEach(function(relatorio)){ %>

                <tr>
                    <td>
                        <%=relatorio.nome_relatorio %>
                    </td>
                    <td>
                        <!-- <%=relatorio.prazo_tarefa %> -->
                        <%= moment(relatorio.prazo_relatorio).format( 'DD/MM/YYYY') %>
                    </td>
                    <td>
                        <%= situacoes[relatorio.situacao_relatorio]%>
                    </td>
                    <td>
                
                        <td>
                            <button onclick=<%=" window.location='/aceitar?id="+ relatorio.id_relatorio+"'" %> class="
                                material-symbols-outlined done_outline">
                                done_outline
                            </button>
                        </td>
                        <td>
                            <button onclick=<%=" window.location='/excluir?id="+ relatorio.id_relatorio+"'" %> class="
                                material-symbols-outlined delete">
                                delete
                            </button>
                        </td>
                    </td>
                </tbody>
            </table>
        </section>
    </section>
        </section>
    <script>
        const tabs= document.querySelectorAll('.tab_btn');
const all_content= document.querySelectorAll('.content');

tabs.forEach((tab, index)=>{
    tab.addEventListener('click', (e)=>{
        tabs.forEach(tab=>{tab.classList.remove('active')});
        tab.classList.add('active');


            var line=document.querySelector('.line');
            line.style.width = e.target.offsetWidth + "px";
            line.style.left = e.target.offsetLeft + "px";

            all_content.forEach(content=>{content.classList.remove('active')});
            all_content[index].classList.add('active');
    });
});

document.addEventListener('DOMContentLoaded', () => {
    const requestTableBody = document.querySelector('#requestTable tbody');
    const paymentTableBody = document.querySelector('#paymentTable tbody');
    const commissionTableBody = document.querySelector('#commissionTable tbody');

    let requestTable = 1;
    let paymentId = 1;
    let commissionId = 1;
    // Criar uma nova linha para a tabela
    const row = document.createElement('tr');
    row.innerHTML = `
        <td>${requestId++}</td>
        <td>${name}</td>
        <td>${number}</td>
        <td>${cep}</td>
        <td>${value}</td>
    `;

    // Adicionar a nova linha à tabela
    requestTableBody.appendChild(row);
    paymentForm.addEventListener('submit', (event) => {
        event.preventDefault();

        const name = document.getElementById('paymentName').value;
        const amount = document.getElementById('paymentAmount').value;

        const row = document.createElement('tr');
        row.innerHTML = `
            <td>${paymentId++}</td>
            <td>${name}</td>
            <td>${amount}</td>
            <td>
                <button class="action-button delete">Deletar</button>
            </td>
        `;

        paymentTableBody.appendChild(row);
        paymentForm.reset();
    });

    // Função para adicionar uma nova linha na tabela de comissões
    commissionForm.addEventListener('submit', (event) => {
        event.preventDefault();

        const professional = document.getElementById('commissionProfessional').value;
        const amount = document.getElementById('commissionAmount').value;

        const row = document.createElement('tr');
        row.innerHTML = `
            <td>${commissionId++}</td>
            <td>${professional}</td>
            <td>${amount}</td>
            <td>
                <button class="action-button delete">Deletar</button>
            </td>
        `;

        commissionTableBody.appendChild(row);
        commissionForm.reset();
    });

});
    </script>
</body>
</html>
